<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Premium Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        dark: '#0f172a', /* Slate 900 */
                        card: '#1e293b', /* Slate 800 */
                        accent: '#6366f1', /* Indigo 500 */
                    }
                }
            }
        }
    </script>
    <style>
        input[type="number"] { -moz-appearance: textfield; }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        input::placeholder { opacity: 0.2; }
    </style>
</head>
<body class="bg-dark text-slate-100 h-screen w-screen flex flex-col overflow-hidden font-sans selection:bg-indigo-500 selection:text-white">

    <header class="flex justify-between items-center px-4 py-2 bg-card/50 backdrop-blur-md border-b border-slate-700/50 shrink-0 h-[8%]">
        <div>
            <h1 class="text-lg font-black tracking-wider text-white uppercase bg-clip-text text-transparent bg-gradient-to-r from-white to-slate-400">
                Shri Gurusiddappa <span class="text-indigo-500">Tra Co.</span>
            </h1>
        </div>
        <a href="view_bills.html" class="group flex items-center gap-2 bg-slate-700/50 hover:bg-indigo-600/20 text-[10px] font-bold px-3 py-1.5 rounded-full border border-slate-600 transition-all">
            <span class="text-slate-200 group-hover:text-indigo-400">History</span>
            <i class="fas fa-arrow-right text-[10px] text-slate-400 group-hover:text-indigo-400"></i>
        </a>
    </header>

    <main class="flex-1 flex flex-col p-2 gap-2 overflow-hidden h-[46%] border-b border-slate-700/50">
        
        <div class="flex gap-2 flex-1 min-h-0">
            <div class="w-1/3 h-full relative group">
                <label class="absolute top-2 left-0 w-full text-center text-[10px] font-bold text-slate-500 uppercase tracking-widest z-10">Bill No</label>
                <input type="number" id="billNo" placeholder="101" 
                    class="w-full h-full pt-4 bg-card border border-slate-700 rounded-xl text-center text-4xl font-black text-white focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition-all placeholder-slate-600">
            </div>
            <div class="w-2/3 h-full">
                <div class="h-full bg-card border border-slate-700 rounded-xl p-1 flex relative">
                    <label class="flex-1 cursor-pointer z-10">
                        <input type="radio" name="commRate" value="0.02" checked onchange="calculate()" class="peer hidden">
                        <div class="w-full h-full flex items-center justify-center rounded-lg text-3xl font-bold text-slate-400 transition-all peer-checked:bg-indigo-600 peer-checked:text-white peer-checked:shadow-lg">2%</div>
                    </label>
                    <label class="flex-1 cursor-pointer z-10 ml-1">
                        <input type="radio" name="commRate" value="0.03" onchange="calculate()" class="peer hidden">
                        <div class="w-full h-full flex items-center justify-center rounded-lg text-3xl font-bold text-slate-400 transition-all peer-checked:bg-indigo-600 peer-checked:text-white peer-checked:shadow-lg">3%</div>
                    </label>
                </div>
            </div>
        </div>

        <div class="flex gap-2 flex-1 min-h-0">
            <div class="w-1/2 relative group h-full">
                <span class="absolute top-3 left-3 text-[10px] font-bold text-slate-500 uppercase tracking-widest">Total</span>
                <span class="absolute left-4 top-1/2 -translate-y-1/2 text-slate-600 text-3xl font-bold mt-1">₹</span>
                <input type="number" id="grossInput" placeholder="0" 
                    class="w-full h-full pl-10 pr-2 pt-5 bg-card border border-slate-700 rounded-xl text-5xl font-black text-white focus:outline-none focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500 transition-all placeholder-slate-600" oninput="calculate()">
            </div>
            <div class="w-1/2 relative group h-full">
                <span class="absolute top-3 left-3 text-[10px] font-bold text-slate-500 uppercase tracking-widest">Net </span>
                <span class="absolute left-4 top-1/2 -translate-y-1/2 text-slate-600 text-3xl font-bold mt-1">₹</span>
                <input type="number" id="netInput" placeholder="0" 
                    class="w-full h-full pl-10 pr-2 pt-5 bg-card border border-slate-700 rounded-xl text-5xl font-black text-white focus:outline-none focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500 transition-all placeholder-slate-600" oninput="calculate()">
            </div>
        </div>

        <div class="flex-1 min-h-0 relative group h-full">
            <span class="absolute top-3 left-5 text-[10px] font-bold text-slate-500 uppercase tracking-widest">Total Bag Count</span>
            <span class="absolute left-6 top-1/2 -translate-y-1/2 text-slate-600 text-3xl mt-1"><i class="fas fa-box"></i></span>
            <input type="number" id="bagInput" placeholder="0" 
                class="w-full h-full pl-16 pr-4 pt-5 bg-card border border-slate-700 rounded-xl text-5xl font-black text-white focus:outline-none focus:border-amber-500 focus:ring-1 focus:ring-amber-500 transition-all placeholder-slate-600" oninput="calculate()">
        </div>
    </main>

    <footer class="flex-1 flex flex-col justify-between p-2 gap-2 bg-card/30 h-[46%]">
        
        <div class="flex-1 grid grid-cols-2 gap-2 min-h-0">
            <div class="bg-dark/50 rounded-xl border border-slate-700/50 flex flex-col items-center justify-center">
                <span class="text-[10px] text-slate-500 uppercase font-bold tracking-wider mb-1">Commission</span>
                <span class="text-4xl font-black text-slate-200">₹<span id="dispComm">0</span></span>
            </div>
            <div class="bg-dark/50 rounded-xl border border-slate-700/50 flex flex-col items-center justify-center">
                <span class="text-[10px] text-slate-500 uppercase font-bold tracking-wider mb-1">Hamali</span>
                <span class="text-4xl font-black text-slate-200">₹<span id="dispHamali">0</span></span>
            </div>
            <div class="col-span-2 bg-rose-900/20 rounded-xl border border-rose-500/20 flex justify-between items-center px-6">
                <span class="text-xs text-rose-400 uppercase font-bold tracking-wider">Commission + Hamali = </span>
                <span class="text-5xl font-black text-rose-400">₹<span id="dispYield">0</span></span>
            </div>
        </div>

        <div class="flex justify-between items-end px-2 py-1">
            <div class="flex flex-col mb-2">
                <span class="text-sm font-bold text-indigo-400 uppercase tracking-wider">Amount Payable</span>
                <span class="text-[10px] text-slate-500">Net - (Commission + Hamali) = </span>
            </div>
            <div class="text-right">
                <span class="text-7xl font-black text-white tracking-tighter drop-shadow-lg leading-none">₹<span id="finalPayable">0</span></span>
            </div>
        </div>

        <button onclick="saveBill()" class="group w-full h-20 bg-gradient-to-r from-indigo-600 to-violet-600 rounded-xl font-bold text-2xl text-white shadow-lg shadow-indigo-500/30 active:scale-95 transition-all duration-200 flex items-center justify-center relative overflow-hidden shrink-0">
            <div class="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></div>
            <span class="relative flex items-center">
                <i class="fas fa-save mr-3 text-indigo-200"></i> Save to history
            </span>
        </button>

    </footer>

    <script>
        function calculate() {
            const gross = parseFloat(document.getElementById('grossInput').value) || 0;
            const net = parseFloat(document.getElementById('netInput').value) || 0;
            const bags = parseFloat(document.getElementById('bagInput').value) || 0;
            
            const rateOptions = document.getElementsByName('commRate');
            let rate = 0.02;
            for(let r of rateOptions) if(r.checked) rate = parseFloat(r.value);

            const commission = Math.round(gross * rate);
            const hamali = bags * 16;
            const yieldAmt = commission + hamali;
            const payable = net - yieldAmt;

            document.getElementById('dispComm').innerText = commission;
            document.getElementById('dispHamali').innerText = hamali;
            document.getElementById('dispYield').innerText = yieldAmt;
            
            const finalDisplay = document.getElementById('finalPayable');
            finalDisplay.innerText = payable;
            
            if (payable < 0) {
                finalDisplay.classList.remove('text-white', 'text-indigo-400');
                finalDisplay.classList.add('text-rose-500');
            } else {
                finalDisplay.classList.remove('text-rose-500');
                finalDisplay.classList.add('text-white');
            }

            return { gross, net, bags, commission, hamali, yieldAmt, payable, rate };
        }

        function saveBill() {
            const billNo = document.getElementById('billNo').value;
            if(!billNo) { 
                const billInput = document.getElementById('billNo');
                billInput.classList.add('border-rose-500', 'ring-1', 'ring-rose-500');
                setTimeout(() => billInput.classList.remove('border-rose-500', 'ring-1', 'ring-rose-500'), 500);
                return; 
            }
            
            const calc = calculate(); 
            if(calc.gross === 0) { return; }

            const newBill = {
                no: billNo,
                gross: calc.gross,
                net: calc.net,
                bags: calc.bags,
                comm: calc.commission,
                hamali: calc.hamali,
                payable: calc.payable,
                rateVal: (calc.rate * 100) + '%'
            };

            const todayKey = new Date().toLocaleDateString('en-GB'); 
            const allData = JSON.parse(localStorage.getItem('dailyBillsStore')) || {};
            if(!allData[todayKey]) allData[todayKey] = [];
            
            allData[todayKey].push(newBill);
            localStorage.setItem('dailyBillsStore', JSON.stringify(allData));

            document.getElementById('billNo').value = '';
            document.getElementById('grossInput').value = '';
            document.getElementById('netInput').value = '';
            document.getElementById('bagInput').value = '';
            document.getElementById('billNo').focus(); 
            calculate(); 
            
            const btn = document.querySelector('button');
            const span = btn.querySelector('span');
            const originalContent = span.innerHTML;
            
            btn.classList.remove('from-indigo-600', 'to-violet-600');
            btn.classList.add('bg-emerald-500'); 
            span.innerHTML = '<i class="fas fa-check-circle mr-2"></i> Saved';
            
            setTimeout(() => {
                btn.classList.add('from-indigo-600', 'to-violet-600');
                btn.classList.remove('bg-emerald-500');
                span.innerHTML = originalContent;
            }, 1200);
        }
    </script>
</body>
</html>